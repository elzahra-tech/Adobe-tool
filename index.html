<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Adobe Stock Metadata Generator</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f9f9f9; }
    h1 { font-size: 24px; }
    #output { white-space: pre-wrap; margin-top: 20px; border: 1px solid #ccc; padding: 10px; background: #fff; }
    button { padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Adobe Stock Metadata Generator</h1>
  <input type="file" id="fileInput" multiple accept="image/*" />
  <button onclick="generateMetadata()">Generate Metadata</button>
  <div id="output"></div>

  <script>
    const API_URL = "https://api-inference.huggingface.co/models/Salesforce/blip-image-captioning-base";
    const API_TOKEN = "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";

    async function generateMetadata() {
      const output = document.getElementById("output");
      const files = document.getElementById("fileInput").files;
      output.innerText = "";

      for (const file of files) {
        output.innerText += `Processing: ${file.name}...\n`;

        try {
          const base64 = await toBase64(file);
          const response = await fetch(API_URL, {
            method: "POST",
            headers: {
              "Authorization": `Bearer ${API_TOKEN}`,
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              inputs: base64
            })
          });

          const result = await response.json();

          if (Array.isArray(result) && result.length > 0 && result[0].generated_text) {
            const caption = result[0].generated_text;
            const keywords = caption
              .replace(/[^\w\s]/g, '')
              .split(' ')
              .filter(word => word.length > 3)
              .slice(0, 50);

            output.innerText += `Title: ${caption}\nKeywords: ${keywords.join(', ')}\n\n`;
          } else {
            output.innerText += `Failed to get metadata for ${file.name}\n\n`;
          }
        } catch (err) {
          output.innerText += `Failed to process ${file.name}: ${err.message}\n\n`;
        }
      }
    }

    function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
      });
    }
  </script>
</body>
</html>
